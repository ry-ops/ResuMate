<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Template System Test - ResuMate</title>
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/navigation.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .control-group {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
        }
        .control-group h3 {
            margin-top: 0;
            font-size: 14px;
            color: #34495e;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        button, select {
            padding: 8px 15px;
            margin: 5px 5px 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            font-size: 13px;
        }
        button:hover, select:hover {
            background: #ecf0f1;
        }
        button.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        input[type="color"] {
            width: 50px;
            height: 30px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }
        .preview-container {
            border: 2px solid #ddd;
            background: white;
            padding: 20px;
            margin-top: 20px;
            overflow: auto;
        }
        .resume-preview {
            margin: 0 auto;
        }
        .status {
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 4px;
            font-size: 13px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info-panel {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-size: 13px;
        }
        .info-panel h4 {
            margin-top: 0;
            color: #2c3e50;
        }
        .info-panel pre {
            background: white;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body id="main-content" tabindex="-1">
    <div class="test-container">
        <h1>Template System Test</h1>
        <p class="subtitle">Testing ResuMate template engine, registry, and customizer</p>

        <div id="status"></div>

        <div class="controls">
            <div class="control-group">
                <h3>Template Selection</h3>
                <button onclick="switchTemplate('classic')" id="btn-classic">Classic</button>
                <button onclick="switchTemplate('modern')" id="btn-modern">Modern</button>
                <button onclick="switchTemplate('creative')" id="btn-creative">Creative</button>
                <button onclick="switchTemplate('executive')" id="btn-executive">Executive</button>
                <button onclick="switchTemplate('technical')" id="btn-technical">Technical</button>
                <button onclick="switchTemplate('minimal')" id="btn-minimal">Minimal</button>
            </div>

            <div class="control-group">
                <h3>Color Presets</h3>
                <select onchange="applyColorPreset(this.value)">
                    <option value="">Select preset...</option>
                    <option value="professional">Professional Blue</option>
                    <option value="executive">Executive Navy</option>
                    <option value="creative">Creative Purple</option>
                    <option value="modern">Modern Green</option>
                    <option value="minimal">Minimal Gray</option>
                    <option value="warm">Warm Orange</option>
                </select>
            </div>

            <div class="control-group">
                <h3>Typography Presets</h3>
                <select onchange="applyTypographyPreset(this.value)">
                    <option value="">Select preset...</option>
                    <option value="classic">Classic Serif</option>
                    <option value="modern">Modern Sans</option>
                    <option value="professional">Professional</option>
                    <option value="creative">Creative Mix</option>
                    <option value="technical">Technical</option>
                </select>
            </div>

            <div class="control-group">
                <h3>Spacing Presets</h3>
                <select onchange="applySpacingPreset(this.value)">
                    <option value="">Select preset...</option>
                    <option value="compact">Compact</option>
                    <option value="normal">Normal</option>
                    <option value="spacious">Spacious</option>
                </select>
            </div>

            <div class="control-group">
                <h3>Page Size</h3>
                <button onclick="setPageSize('letter')">US Letter</button>
                <button onclick="setPageSize('a4')">A4</button>
            </div>

            <div class="control-group">
                <h3>Actions</h3>
                <button onclick="resetCustomizations()">Reset All</button>
                <button onclick="showTemplateInfo()">Show Info</button>
            </div>
        </div>

        <div class="info-panel" id="info-panel" style="display: none;">
            <h4>Current Template Information</h4>
            <pre id="template-info"></pre>
        </div>

        <div class="preview-container">
            <div class="resume-preview template-classic" id="resume-preview">
                <div class="resume-page page-letter">
                    <div class="resume-header">
                        <h1 class="resume-name">John Doe</h1>
                        <div class="resume-title">Senior Software Engineer</div>
                        <div class="resume-contact">
                            <span class="resume-contact-item">john.doe@email.com</span>
                            <span class="resume-contact-separator">|</span>
                            <span class="resume-contact-item">(555) 123-4567</span>
                            <span class="resume-contact-separator">|</span>
                            <span class="resume-contact-item">San Francisco, CA</span>
                        </div>
                    </div>

                    <div class="resume-section resume-summary">
                        <h2 class="section-title">Professional Summary</h2>
                        <p class="summary-text">
                            Results-driven software engineer with 8+ years of experience building scalable web applications.
                            Expertise in full-stack development, cloud architecture, and team leadership. Proven track record
                            of delivering high-quality solutions that drive business growth.
                        </p>
                    </div>

                    <div class="resume-section">
                        <h2 class="section-title">Experience</h2>

                        <div class="experience-item">
                            <div class="experience-header">
                                <h3 class="job-title">Senior Software Engineer</h3>
                                <div class="company-name">Tech Corp</div>
                                <div class="job-meta">
                                    <span class="job-location">San Francisco, CA</span>
                                    <span class="job-dates">Jan 2020 - Present</span>
                                </div>
                            </div>
                            <div class="job-description">
                                <ul>
                                    <li>Led development of microservices architecture serving 10M+ users</li>
                                    <li>Reduced system latency by 45% through optimization and caching strategies</li>
                                    <li>Mentored team of 5 junior engineers and conducted code reviews</li>
                                </ul>
                            </div>
                        </div>

                        <div class="experience-item">
                            <div class="experience-header">
                                <h3 class="job-title">Software Engineer</h3>
                                <div class="company-name">StartupXYZ</div>
                                <div class="job-meta">
                                    <span class="job-location">Mountain View, CA</span>
                                    <span class="job-dates">Mar 2016 - Dec 2019</span>
                                </div>
                            </div>
                            <div class="job-description">
                                <ul>
                                    <li>Built RESTful APIs using Node.js and Express serving 1M requests/day</li>
                                    <li>Implemented CI/CD pipeline reducing deployment time by 60%</li>
                                    <li>Collaborated with product team to define technical requirements</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="resume-section">
                        <h2 class="section-title">Education</h2>

                        <div class="education-item">
                            <h3 class="degree">Bachelor of Science in Computer Science</h3>
                            <div class="institution">Stanford University</div>
                            <div class="education-meta">
                                <span class="education-dates">2012 - 2016</span>
                                <span class="education-location">Stanford, CA</span>
                            </div>
                            <div class="education-gpa">GPA: 3.8/4.0</div>
                        </div>
                    </div>

                    <div class="resume-section">
                        <h2 class="section-title">Skills</h2>
                        <ul class="skills-list">
                            <li class="skill-category">
                                <span class="skill-category-name">Languages:</span>
                                <span class="skill-items">JavaScript, Python, Java, Go</span>
                            </li>
                            <li class="skill-category">
                                <span class="skill-category-name">Frameworks:</span>
                                <span class="skill-items">React, Node.js, Express, Django</span>
                            </li>
                            <li class="skill-category">
                                <span class="skill-category-name">Cloud:</span>
                                <span class="skill-items">AWS, Docker, Kubernetes, Terraform</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load template system scripts -->
    <script src="js/templates/registry.js"></script>
    <script src="js/templates/engine.js"></script>
    <script src="js/templates/customizer.js"></script>

    <script>
        // Initialize template system
        document.addEventListener('DOMContentLoaded', () => {
            showStatus('Template system initialized', 'success');

            // Initialize engine
            window.TemplateEngine.init();

            // Set default active button
            document.getElementById('btn-classic').classList.add('active');

            // Add engine event listener
            window.TemplateEngine.addEventListener((event, data) => {
                console.log('Template event:', event, data);
                if (event === 'templateChanged' || event === 'templateSwitched') {
                    showStatus(`Template changed to: ${data.name || data.to}`, 'success');
                }
            });
        });

        function showStatus(message, type = 'success') {
            const statusDiv = document.getElementById('status');
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';

            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }

        async function switchTemplate(templateId) {
            const preview = document.getElementById('resume-preview');

            // Remove all template classes
            preview.className = 'resume-preview';

            // Add new template class
            preview.classList.add(`template-${templateId}`);

            // Load template via engine
            const success = await window.TemplateEngine.switchTemplate(templateId);

            if (success) {
                // Update active button
                document.querySelectorAll('.control-group button').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.getElementById(`btn-${templateId}`).classList.add('active');

                showStatus(`Switched to ${templateId} template`, 'success');
            } else {
                showStatus(`Failed to load ${templateId} template`, 'error');
            }
        }

        function applyColorPreset(presetName) {
            if (!presetName) return;

            const success = window.TemplateCustomizer.applyColorPreset(presetName);
            if (success) {
                showStatus(`Applied ${presetName} color preset`, 'success');
            } else {
                showStatus(`Failed to apply color preset`, 'error');
            }
        }

        function applyTypographyPreset(presetName) {
            if (!presetName) return;

            const success = window.TemplateCustomizer.applyTypographyPreset(presetName);
            if (success) {
                showStatus(`Applied ${presetName} typography preset`, 'success');
            } else {
                showStatus(`Failed to apply typography preset`, 'error');
            }
        }

        function applySpacingPreset(presetName) {
            if (!presetName) return;

            const success = window.TemplateCustomizer.applySpacingPreset(presetName);
            if (success) {
                showStatus(`Applied ${presetName} spacing preset`, 'success');
            } else {
                showStatus(`Failed to apply spacing preset`, 'error');
            }
        }

        function setPageSize(size) {
            const success = window.TemplateCustomizer.setPageSize(size);
            if (success) {
                showStatus(`Set page size to ${size}`, 'success');
            }
        }

        function resetCustomizations() {
            window.TemplateCustomizer.reset();
            showStatus('Reset all customizations', 'success');

            // Reset all dropdowns
            document.querySelectorAll('select').forEach(select => {
                select.value = '';
            });
        }

        function showTemplateInfo() {
            const template = window.TemplateEngine.getCurrentTemplate();
            const customizations = window.TemplateCustomizer.getCurrentCustomizations();
            const registry = window.TemplateRegistry;

            const info = {
                currentTemplate: template,
                customizations: customizations,
                availableTemplates: registry.getAllTemplates().map(t => ({
                    id: t.id,
                    name: t.name,
                    atsScore: t.atsScore,
                    category: t.category
                })),
                registryStats: registry.getStats()
            };

            document.getElementById('template-info').textContent = JSON.stringify(info, null, 2);
            document.getElementById('info-panel').style.display = 'block';
        }
    </script>
    <script src="js/navigation/loader.js"></script>
</body>
</html>
